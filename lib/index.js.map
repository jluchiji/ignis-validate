{"version":3,"sources":["index.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;sBAOwB,QAAQ;;;;qBACR,OAAO;;;;iCACP,oBAAoB;;;;IAIvB,iBAAiB;YAAjB,iBAAiB;;WAAjB,iBAAiB;;;;;;eAAjB,iBAAiB;;+BAE1B,WAAC,IAAI,EAAE;AACf,UAAI,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;KACxB;;;;;;;WAMM,iBAAC,KAAK,EAAE,IAAI,EAAE;AACnB,UAAI,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;AACzB,UAAI,CAAC,MAAM,EAAE;AAAE,eAAO,IAAI,CAAC;OAAE;;;AAG7B,YAAM,KAAK,GAAG,oBAAE,OAAO,CAAC,oBAAE,GAAG,EAAE,MAAM,CAAC,CAAC;AACvC,UAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,EAAE;AACzD,cAAM,GAAG,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;OAC3B;;AAED,aAAO,+BAAW,QAAQ,CAAC,MAAM,CAAC,CAAC;KACpC;;;2BArBkB,iBAAiB;AAAjB,mBAAiB,GADrC,mBAAM,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,CACN,iBAAiB,KAAjB,iBAAiB;SAAjB,iBAAiB;GAAS,mBAAM,OAAO;;qBAAvC,iBAAiB","file":"index.js","sourcesContent":["/**\n * index.js\n *\n * @author  Denis Luchkin-Zhou <denis@ricepo.com>\n * @license MIT\n */\n\nimport _           from 'lodash';\nimport Ignis       from 'ignis';\nimport JsonSchema  from 'express-jsonschema';\n\n\n@Ignis.Service.deps('http')\nexport default class ValidationService extends Ignis.Service {\n\n  async init(http) {\n    http.pre(this.factory);\n  }\n\n\n  /**\n   * Validation middleware factory\n   */\n  factory(ignis, meta) {\n    let schema = meta.schema;\n    if (!schema) { return null; }\n\n    /* Default to validating body */\n    const check = _.partial(_.has, schema);\n    if (!check('body') && !check('query') && !check('params')) {\n      schema = { body: schema };\n    }\n\n    return JsonSchema.validate(schema);\n  }\n\n}\n"],"sourceRoot":"/source/"}